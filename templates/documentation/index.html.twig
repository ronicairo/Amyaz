{% extends 'base.html.twig' %}

{% block title %}
	{{ 'documentation.title'|trans }}
{% endblock %}

{% block body %}
	<style>
		.search-form {
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 0 5px;
		}

		.search-form input:focus {
			outline: none;
			box-shadow: none;
		}

		.search-form > div {
			position: relative;
			display: flex;
			box-shadow: 5px 5px 5px 2px rgba(0, 0, 0, 0.5);
			border-radius: 20px;
			width: 100%;
			max-width: 600px;
			overflow: hidden;
		}

		.search-form select {
			padding: 12.5px 30px 12.5px 12.5px;
			font-size: 16px;
			border: none;
			background-color: rgba(255, 255, 255, 0.8);
			border-radius: 20px 0 0 20px;
			flex-grow: 0;
			min-width: 80px; /* Réduction de la largeur minimale */
			max-width: 120px; /* Définir une largeur maximale */
			appearance: none; /* Masquer l'apparence native */
			-webkit-appearance: none; /* Masquer l'apparence native dans WebKit */
			-moz-appearance: none; /* Masquer l'apparence native dans Firefox */
			cursor: pointer;
			background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAiIGhlaWdodD0iNiIgdmlld0JveD0iMCAwIDEwIDYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTSAwLjQ1NzAzOTM5LDEuMzk2MDMgTCAxLjI5MzY4MywwLjU1MDI4NTcgTCA1LDAuNTUwMjg1NyBMIDguNzA2MzIsMC41NTAyODU3IEwgOS41NDI5NiwwLjU1MDI4NTcgTCA1LDQuNTc4OTcgWiIgZmlsbD0iIzAwMCIvPjwvc3ZnPg==');
			background-repeat: no-repeat;
			background-position: right 10px center; /* Positionnement de la flèche */ /* Espace pour la flèche */
		}

		.search-form select::-ms-expand {
			display: none; /* Masquer la flèche native dans IE */
		}

		.search-form input[type="text"] {
			padding: 10px;
			font-size: 16px;
			border: none;
			background-color: rgba(255, 255, 255, 0.8);
			flex: 2;
			min-width: 0;
		}

		.search-form .search-button {
			padding: 10px 20px;
			font-size: 16px;
			background-color: rgba(0, 0, 0, 0.7);
			color: white;
			border: none;
			cursor: pointer;
			transition: background-color 0.3s ease;
			border-radius: 0 20px 20px 0;
		}

		.search-form button:hover {
			background-color: #A0BBD4;
		}

		/* Responsive Styles */
		@media(max-width: 768px) {
			.search-form,
			.search-form > div {
				max-width: 100%;
			}

			.search-form select,
			.search-form input[type="text"],
			.search-form button {
				font-size: 14px;
			}

			.search-form select {
				min-width: 60px;
			}

			.search-form input[type="text"] {
				flex: 1;
				padding: 8px;
			}

			.search-form .search-button {
				padding: 8px 16px;
			}
		}

		@media(max-width: 480px) {
			.search-form select,
			.search-form input[type="text"],
			.search-form button {
				font-size: 12px;
			}

			.search-form select {
				min-width: 60px; /* Réduction encore plus importante sur les écrans < 480px */
				max-width: 100px;
			}

			/* Enlever le bleu du select sur les téléphones */
			.search-form select {
				color: black !important;
				background-color: rgba(255, 255, 255, 0.8) !important;
			}
		}

		.btn-container {
			display: flex;
			justify-content: center;
			margin-bottom: 20px;
		}

		.card {
			position: relative; /* This is important for absolute positioning within the card */
			background-color: transparent;
			border-radius: 20px;
			box-shadow: 0 15px 25px rgba(0, 0, 0, 0.6);
		}

		.card .edit-icon {
			position: absolute;
			top: 10px;
			right: 10px;
			color: black;
		}
	</style>

	<div class="col-11 mx-auto">
		{% include 'include/flashes.html.twig' %}
	</div>

	<div class="rounded-3">
		<div class="container-fluid">
			<h1 class="display-5 fw-bold text-center">{{ 'documentation.title'|trans }}</h1>
			<p class="text-center">{{ 'documentation.resume'|trans|raw }}</p>
		</div>
	</div>

	<div class="container">
		<div class="btn-container">
			{% if is_granted('ROLE_ADMIN') or is_granted('ROLE_MODERATOR') %}
				<a href="{{ path('documentation_new') }}" class="btn btn-dark mb-2">{{ 'title.create_doc'|trans }}</a>
			{% endif %}
		</div>

		<form id="searchForm" method="GET" action="{{ path('documentation_index') }}" class="search-form">
			<div>
				<select name="category">
					<option value="" {% if selectedCategory is empty %} selected {% endif %}>{{ 'form.choisir_categorie'|trans }}</option>
					{% for category in categories %}
						<option value="{{ category.id }}" {% if category.id == selectedCategory %} selected {% endif %}>{{ category.name }}</option>
					{% endfor %}
				</select>
				<input type="text" name="q" id="search-input" placeholder="{{ 'form.rechercher'|trans }}" value="{{ searchTerm }}" aria-label="Search">
				<button type="submit" class="search-button">
					<i class="bi bi-search"></i>
				</button>
			</div>
		</form>

	</div>

	<div class="container">
		<div class="row">
			{% for documentation in pagination %}
				<div class="col-md-6 mb-4 mt-4">
					<div class="card h-100 p-5 text-dark">
						{% if is_granted('ROLE_ADMIN') or is_granted('ROLE_MODERATOR') %}
							<a href="{{ path('documentation_edit', {'id': documentation.id}) }}" class="edit-icon">
								<i class="bi bi-pencil"></i>
							</a>
						{% endif %}
						<div class="d-flex justify-content-between align-items-center">
							<h2 class="mb-0">
								{% if app.request.locale == 'fr' %}
									{{ documentation.titleFr }}
								{% else %}
									{{ documentation.titleEn }}
								{% endif %}
							</h2>
						</div>
						<p>
							{% if app.request.locale == 'fr' %}
								{{ documentation.contentFr }}
							{% else %}
								{{ documentation.contentEn }}
							{% endif %}
						</p>
						<p>{{ documentation.category }}</p>
						<a style="color: #333;" href="{{ asset('uploads/' ~ documentation.file) }}" download="{{ documentation.file }}">{{ 'button.pdf'|trans }}</a>
					</div>
				</div>
			{% else %}
				<div class="col-12 text-center">
					<p class="mt-3">{{ 'p.no_result'|trans }}</p>
				</div>
			{% endfor %}
		</div>
	</div>

	<div id="pagination-container" class="pagination justify-content-center mt-4">
		{{ knp_pagination_render(pagination) }}
	</div>

{% endblock %}
